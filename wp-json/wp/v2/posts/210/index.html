{"id":210,"date":"2018-11-24T10:15:04","date_gmt":"2018-11-24T10:15:04","guid":{"rendered":"http:\/\/localhost\/vps640544\/noteandocom\/?p=210"},"modified":"2018-12-20T12:54:40","modified_gmt":"2018-12-20T12:54:40","slug":"descargar-archivo-por-ftp-con-python","status":"publish","type":"post","link":"http:\/\/localhost\/vps640544\/noteandocom\/codigos-python\/descargar-archivo-por-ftp-con-python\/","title":{"rendered":"Descargar archivo por FTP con Python"},"content":{"rendered":"<p>Si necesitamos descargar alg\u00fan archivo desde un servidor remoto, lo podemos hacer gracias a Python.<br \/>\nEntre las diferentes utilidades que se le puede dar a este peque\u00f1o pedazo de c\u00f3digo seria la de por ejemplo hacer descargar los Backups de un servidor de forma autom\u00e1tica.<\/p>\n<p>&nbsp;<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"python\">\"\"\"\r\nRecursively backup all the files from a remote directory using ftp.\r\n\"\"\"\r\n\r\n# information about the source ftp server\r\n# and the target directory on my laptop\r\n\r\nhostname = 'ftp.dlptest.com'\r\nusername = 'dlpuser@dlptest.com'\r\npassword = 'e73jzTRTNqCN9PYAAjjn'\r\nstart_directory = '\/'\r\nbackup_dir = 'C:\\\\Users\\\\Oficina\\\\Desktop\\\\back_wp\\\\hidro\\\\'\r\n\r\nimport ftplib\r\nimport os\r\nimport datetime\r\n\r\ndef get_files_directories():\r\n\r\n    dirlisting = []\r\n    \r\n    ftp_obj.retrlines('LIST',callback=dirlisting.append)\r\n    \r\n    files = []\r\n    directories = []\r\n    \r\n    for l in dirlisting:\r\n        lastspace = l.rindex(' ')\r\n        file_name = l[lastspace+1:]\r\n        if l[0] == 'd':\r\n            directories.append(file_name)\r\n        elif l[0] == '-':\r\n            files.append(file_name)\r\n            \r\n    return files,directories\r\n    \r\ndef backup_directory(local_dir,remote_dir):\r\n\r\n    os.chdir(local_dir)\r\n    ftp_obj.cwd(remote_dir)\r\n    print('In directory '+remote_dir)\r\n\r\n    files,directories = get_files_directories()\r\n\r\n    for f in files:\r\n        print('Backing up OK'+f)\r\n        try:\r\n            ftp_obj.retrbinary('RETR '+f, open(f, 'wb').write)\r\n        except ftplib.error_perm:\r\n            print('Skipping '+f+' due to permissions')\r\n        \r\n    for d in directories:\r\n        newremote = remote_dir+d+'\/'\r\n        newlocal = local_dir+'\\\\'+d\r\n        try:\r\n            os.mkdir(newlocal)\r\n        except:\r\n            continue\r\n        backup_directory(newlocal,newremote)\r\n        \r\n# Main program\r\n\r\n# backup directories under here\r\n\r\nos.chdir(backup_dir)\r\n\r\n# Create directory with today's date\r\n\r\ndatestring = str(datetime.date.today())\r\n\r\nos.mkdir(datestring)\r\nos.chdir(datestring)\r\nlocal_dir = os.getcwd()\r\n\r\n# connect to ftp server\r\n\r\nftp_obj = ftplib.FTP(host=hostname, user=username, passwd=password)\r\n\r\n# back up everthing from top directory\r\n\r\nremote_dir = start_directory\r\n\r\nbackup_directory(local_dir,remote_dir)\r\n\r\n# quit ftp connection\r\n\r\nftp_obj.quit()\r\n\r\n\r\n<\/pre>\n","protected":false},"excerpt":{"rendered":"<p>Si necesitamos descargar alg\u00fan archivo desde un servidor remoto, lo podemos hacer gracias a Python. Entre las diferentes utilidades que se le puede dar a este peque\u00f1o pedazo de c\u00f3digo&#8230;<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[5],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v14.9 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>\u25b7 Descargar archivo por FTP con Python \u2705<\/title>\n<meta name=\"description\" content=\"\ud83d\udccb\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"http:\/\/localhost\/vps640544\/noteandocom\/codigos-python\/descargar-archivo-por-ftp-con-python\/\" \/>\n<meta property=\"og:locale\" content=\"es_ES\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"\u25b7 Descargar archivo por FTP con Python \u2705\" \/>\n<meta property=\"og:description\" content=\"\ud83d\udccb\" \/>\n<meta property=\"og:url\" content=\"http:\/\/localhost\/vps640544\/noteandocom\/codigos-python\/descargar-archivo-por-ftp-con-python\/\" \/>\n<meta property=\"og:site_name\" content=\"NOTEando\" \/>\n<meta property=\"article:published_time\" content=\"2018-11-24T10:15:04+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2018-12-20T12:54:40+00:00\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\n\t    \"@context\": \"https:\/\/schema.org\",\n\t    \"@graph\": [\n\t        {\n\t            \"@type\": \"WebSite\",\n\t            \"@id\": \"http:\/\/localhost\/vps640544\/noteandocom\/#website\",\n\t            \"url\": \"http:\/\/localhost\/vps640544\/noteandocom\/\",\n\t            \"name\": \"NOTEando\",\n\t            \"description\": \"Optimiza tu Tiempo y Aprender M\\u00e1s\",\n\t            \"potentialAction\": [\n\t                {\n\t                    \"@type\": \"SearchAction\",\n\t                    \"target\": \"http:\/\/localhost\/vps640544\/noteandocom\/?s={search_term_string}\",\n\t                    \"query-input\": \"required name=search_term_string\"\n\t                }\n\t            ],\n\t            \"inLanguage\": \"es\"\n\t        },\n\t        {\n\t            \"@type\": \"WebPage\",\n\t            \"@id\": \"http:\/\/localhost\/vps640544\/noteandocom\/codigos-python\/descargar-archivo-por-ftp-con-python\/#webpage\",\n\t            \"url\": \"http:\/\/localhost\/vps640544\/noteandocom\/codigos-python\/descargar-archivo-por-ftp-con-python\/\",\n\t            \"name\": \"\\u25b7 Descargar archivo por FTP con Python \\u2705\",\n\t            \"isPartOf\": {\n\t                \"@id\": \"http:\/\/localhost\/vps640544\/noteandocom\/#website\"\n\t            },\n\t            \"datePublished\": \"2018-11-24T10:15:04+00:00\",\n\t            \"dateModified\": \"2018-12-20T12:54:40+00:00\",\n\t            \"author\": {\n\t                \"@id\": \"http:\/\/localhost\/vps640544\/noteandocom\/#\/schema\/person\/ec7bb0e55bb126be5a57dff04011b40b\"\n\t            },\n\t            \"description\": \"\\ud83d\\udccb\",\n\t            \"inLanguage\": \"es\",\n\t            \"potentialAction\": [\n\t                {\n\t                    \"@type\": \"ReadAction\",\n\t                    \"target\": [\n\t                        \"http:\/\/localhost\/vps640544\/noteandocom\/codigos-python\/descargar-archivo-por-ftp-con-python\/\"\n\t                    ]\n\t                }\n\t            ]\n\t        },\n\t        {\n\t            \"@type\": \"Person\",\n\t            \"@id\": \"http:\/\/localhost\/vps640544\/noteandocom\/#\/schema\/person\/ec7bb0e55bb126be5a57dff04011b40b\",\n\t            \"name\": \"Francisco Lopez\",\n\t            \"image\": {\n\t                \"@type\": \"ImageObject\",\n\t                \"@id\": \"http:\/\/localhost\/vps640544\/noteandocom\/#personlogo\",\n\t                \"inLanguage\": \"es\",\n\t                \"url\": \"http:\/\/1.gravatar.com\/avatar\/ab115eb8c5aeeec0d4acce25fd9ef494?s=96&d=mm&r=g\",\n\t                \"caption\": \"Francisco Lopez\"\n\t            }\n\t        }\n\t    ]\n\t}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"http:\/\/localhost\/vps640544\/noteandocom\/wp-json\/wp\/v2\/posts\/210"}],"collection":[{"href":"http:\/\/localhost\/vps640544\/noteandocom\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/localhost\/vps640544\/noteandocom\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/vps640544\/noteandocom\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/vps640544\/noteandocom\/wp-json\/wp\/v2\/comments?post=210"}],"version-history":[{"count":0,"href":"http:\/\/localhost\/vps640544\/noteandocom\/wp-json\/wp\/v2\/posts\/210\/revisions"}],"wp:attachment":[{"href":"http:\/\/localhost\/vps640544\/noteandocom\/wp-json\/wp\/v2\/media?parent=210"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/localhost\/vps640544\/noteandocom\/wp-json\/wp\/v2\/categories?post=210"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/localhost\/vps640544\/noteandocom\/wp-json\/wp\/v2\/tags?post=210"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}